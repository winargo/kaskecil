doctype html
head
  meta(http-equiv='Content-Type' content='text/html; charset=UTF-8')
  // Meta, title, CSS, favicons, etc.
  meta(charset='utf-8')
  meta(http-equiv='X-UA-Compatible' content='IE=edge')
  meta(name='viewport' content='width=device-width, initial-scale=1')
  title Account&amp;Category Report
  link(href='https://cdn.datatables.net/1.10.19/css/dataTables.material.min.css' rel='stylesheet')
  link(href='https://cdnjs.cloudflare.com/ajax/libs/material-design-lite/1.1.0/material.min.css' rel='stylesheet')
  //- link(href='https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css' rel='stylesheet')
  //- link(href='https://cdn.datatables.net/1.10.19/css/dataTables.semanticui.min.css' rel='stylesheet')
  link(href='https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.3.1/semantic.min.css' rel='stylesheet')
  link(href='https://cdn.datatables.net/buttons/1.5.6/css/buttons.semanticui.min.css' rel='stylesheet')

  // Bootstrap
  link(rel='stylesheet' href='../vendors/bootstrap/dist/css/bootstrap.min.css')
  
  // Font Awesome
  link(rel='stylesheet' href='../vendors/font-awesome/css/font-awesome.min.css' )
  // NProgress
  link(href='../vendors/nprogress/nprogress.css' rel='stylesheet')
  // bootstrap-daterangepicker
  link(href='../vendors/bootstrap-daterangepicker/daterangepicker.css' rel='stylesheet')
  // Custom Theme Style
  link(href='../build/css/custom.min.css' rel='stylesheet')
  
  //- script(src='https://code.jquery.com/jquery-3.3.1.slim.min.js' integrity='sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo' crossorigin='anonymous')
  //- script(src='https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js' integrity='sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy' crossorigin='anonymous')

  // jQuery
  script(type="text/javascript" src='../vendors/jquery/dist/jquery.min.js')
  // Bootstrap
  script(type="text/javascript" src='../vendors/bootstrap/dist/js/bootstrap.min.js')

  //- <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
  //- <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
  script(src="https://www.gstatic.com/charts/loader.js")

body.nav-md
  .container.body
    .main_container
      .col-md-3.left_col
        .left_col.scroll-view
          .navbar.nav_title(style='border: 0;')
            a.site_title.d-flex.p-3.bg-secondary(href='index.html')
              img.img-circle(src='../images/logo.jpg')
              span &nbsp;Prima Cash
          .clearfix
          // menu profile quick info
          .profile.clearfix
            .profile_pic
              img.img-circle.profile_img(src='../images/img.jpg' alt='...')
            .profile_info
              span Welcome,
              h2 #{username}
          // /menu profile quick info
          br
          // sidebar menu
          #sidebar-menu.main_menu_side.hidden-print.main_menu
            .menu_section
              h3 General
              ul.nav.side-menu
                li
                  a(href='/dashboard')
                    i.fa.fa-home
                    |  Home 
                li
                  a(href='/account')
                    i.fa.fa-users
                    |  Account 
                li
                  a(href='/category')
                    i.fa.fa-list-ol
                    |  Category 
                li
                  a
                    i.fa.fa-money
                    |  Transaction 
                    span.fa.fa-chevron-down
                  ul.nav.child_menu
                    li
                      a(href='/income') Income
                    li
                      a(href='/expense') Expense
                    li
                      a(href='/transfer') Transfer
                li
                  a
                    i.fa.fa-clipboard
                    |  Report
                    span.fa.fa-chevron-down
                  ul.nav.child_menu
                    li.active
                      a Account&amp;Category Report
                    li
                      a(href='/report/cob') Chart Of Balance
                    li
                      a(href='media_gallery.html') Expense Report
                    li
                      a(href='typography.html') Transfer Report
                li
                  a
                    i.fa.fa-bar-chart-o
                    |  Charts 
                    span.fa.fa-chevron-down
                  ul.nav.child_menu
                    li
                      a(href='general_elements.html') Income Chart
                    li
                      a(href='media_gallery.html') Expense Chart
                    li
                      a(href='typography.html') Transfer Chart
                    li
                      a(href='chart.html') All Chart
            .menu_section
              h3 Live On
              ul.nav.side-menu
                li
                  a
                    i.fa.fa-bug
                    |  Additional Pages 
                    span.fa.fa-chevron-down
                  ul.nav.child_menu
                    li
                      a(href='e_commerce.html') E-commerce
                    li
                      a(href='projects.html') Projects
                    li
                      a(href='project_detail.html') Project Detail
                    li
                      a(href='contacts.html') Contacts
                    li
                      a(href='profile.html') Profile
                li
                  a
                    i.fa.fa-windows
                    |  Extras 
                    span.fa.fa-chevron-down
                  ul.nav.child_menu
                    li
                      a(href='page_403.html') 403 Error
                    li
                      a(href='page_404.html') 404 Error
                    li
                      a(href='page_500.html') 500 Error
                    li
                      a(href='plain_page.html') Plain Page
                    li
                      a(href='login.html') Login Page
                    li
                      a(href='pricing_tables.html') Pricing Tables
                li
                  a
                    i.fa.fa-sitemap
                    |  Multilevel Menu 
                    span.fa.fa-chevron-down
                  ul.nav.child_menu
                    li
                      a(href='#level1_1') Level One
                    li
                      a
                        | Level One
                        span.fa.fa-chevron-down
                      ul.nav.child_menu
                        li.sub_menu
                          a(href='level2.html') Level Two
                        li
                          a(href='#level2_1') Level Two
                        li
                          a(href='#level2_2') Level Two
                    li
                      a(href='#level1_2') Level One
                li
                  a(href='javascript:void(0)')
                    i.fa.fa-laptop
                    |  Landing Page 
                    span.label.label-success.pull-right Coming Soon
          // /sidebar menu
          // /menu footer buttons
          .sidebar-footer.hidden-small
            a(data-toggle='tooltip' data-placement='top' title='Settings')
              span.glyphicon.glyphicon-cog(aria-hidden='true')
            a(data-toggle='tooltip' data-placement='top' title='FullScreen')
              span.glyphicon.glyphicon-fullscreen(aria-hidden='true')
            a#refresh(data-toggle='tooltip' data-placement='top' title='Refresh')
              span.glyphicon.glyphicon-refresh(aria-hidden='true')
            a(data-toggle='tooltip' data-placement='top' title='Logout' onclick='logout();')
              span.glyphicon.glyphicon-log-out(aria-hidden='true')
          // /menu footer buttons
      // top navigation

      .top_nav
        .nav_menu
          nav
            .nav.toggle
              a#menu_toggle
                i.fa.fa-bars
            ul.nav.navbar-nav.navbar-right
              li
                a.user-profile.dropdown-toggle(href='javascript:;' data-toggle='dropdown' aria-expanded='false')
                  img(src='../images/img.jpg' alt='')
                  | #{username}
                  span.fa.fa-angle-down
                ul.dropdown-menu.dropdown-usermenu.pull-right
                  li
                    a(href='javascript:;')  Profile
                  li
                    a(href='javascript:;')
                      span.badge.bg-red.pull-right 50%
                      span Settings
                  li
                    a(href='javascript:;') Help
                  li
                    a(onclick='logout();')
                      i.fa.fa-sign-out.pull-right
                      |  Log Out
              li.dropdown(role='presentation')
                a.dropdown-toggle.info-number(href='javascript:;' data-toggle='dropdown' aria-expanded='false')
                  i.fa.fa-envelope-o
                  span.badge.bg-green 6
                ul#menu1.dropdown-menu.list-unstyled.msg_list(role='menu')
                  li
                    a
                      span.image
                        img(src='../images/img.jpg' alt='Profile Image')
                      span
                        span John Smith
                        span.time 3 mins ago
                      span.message
                        | Film festivals used to be do-or-die moments for movie makers. They were where...
                  li
                    a
                      span.image
                        img(src='../images/img.jpg' alt='Profile Image')
                      span
                        span John Smith
                        span.time 3 mins ago
                      span.message
                        | Film festivals used to be do-or-die moments for movie makers. They were where...
                  li
                    a
                      span.image
                        img(src='../images/img.jpg' alt='Profile Image')
                      span
                        span John Smith
                        span.time 3 mins ago
                      span.message
                        | Film festivals used to be do-or-die moments for movie makers. They were where...
                  li
                    a
                      span.image
                        img(src='../images/img.jpg' alt='Profile Image')
                      span
                        span John Smith
                        span.time 3 mins ago
                      span.message
                        | Film festivals used to be do-or-die moments for movie makers. They were where...
                  li
                    .text-center
                      a
                        strong See All Alerts
                        i.fa.fa-angle-right

      // /top navigation
      // page content
      .right_col(role='main')
        .row.top_tiles
          .col-md-12
            .x_panel
              .x_title
                h2
                  | Account&amp;Category Report
                  // Button trigger modal
                
                ul.navbar-right.panel_toolbox(style='list-style-type: none;')
                  li
                    a.collapse-link
                      i.fa.fa-chevron-up
                .clearfix
              .x_content
                .row(style='border-bottom: 1px solid #E0E0E0; padding-bottom: 5px; margin-bottom: 5px;')
                  each x in listcategory
                    .row.w3-margin-bottom
                      h3(style="margin-left:24px") Category : #{x.category_name}
                      .table-responsive-md.col-md-12
                        table.table.table-hover.table-striped.table-bordered(id="tableAcc"+x.category_name cellpadding="1" cellspacing="1")
                          thead
                            tr
                              td Account Last Used
                              td Account Name
                              td Account Currency
                              td Account Category
                              td Account Current Balance
      // page content
      // footer content
      footer
        .pull-right
          | Gentelella - Bootstrap Admin Template by 
          a(href='https://colorlib.com') Colorlib
        .clearfix
      // footer content
  script(src="../js/axios.min.js")
    // FastClick
  script(type="text/javascript" src='../vendors/fastclick/lib/fastclick.js')
  // NProgress
  script(type="text/javascript" src='../vendors/nprogress/nprogress.js')
  // Chart.js
  script(type="text/javascript" src='../vendors/Chart.js/dist/Chart.min.js')
  // jQuery Sparklines
  script(type="text/javascript" src='../vendors/jquery-sparkline/dist/jquery.sparkline.min.js')
  // Flot
  script(type="text/javascript" src='../vendors/Flot/jquery.flot.js')
  script(type="text/javascript" src='../vendors/Flot/jquery.flot.pie.js')
  script(type="text/javascript" src='../vendors/Flot/jquery.flot.time.js')
  script(type="text/javascript" src='../vendors/Flot/jquery.flot.stack.js')
  script(type="text/javascript" src='../vendors/Flot/jquery.flot.resize.js')
  // Flot plugins
  script(type="text/javascript" src='../vendors/flot.orderbars/js/jquery.flot.orderBars.js')
  script(type="text/javascript" src='../vendors/flot-spline/js/jquery.flot.spline.min.js')
  script(type="text/javascript" src='../vendors/flot.curvedlines/curvedLines.js')
  // DateJS
  script(type="text/javascript" src='../vendors/DateJS/build/date.js')
  // bootstrap-daterangepicker
  script(type="text/javascript" src='../vendors/moment/min/moment.min.js')
  script(type="text/javascript" src='../vendors/bootstrap-daterangepicker/daterangepicker.js')
  // Custom Theme Scripts
  script(type="text/javascript" src='../build/js/custom.min.js')
  script(type="text/javascript" src="//cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js")

  script(type="text/javascript" src='https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js')
  
  script(type="text/javascript" src='https://cdn.datatables.net/1.10.19/js/dataTables.semanticui.min.js')
  script(type="text/javascript" src='https://cdn.datatables.net/buttons/1.5.6/js/dataTables.buttons.min.js')
  script(type="text/javascript" src='https://cdn.datatables.net/buttons/1.5.6/js/buttons.semanticui.min.js')
  script(type="text/javascript" src='https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js')
  script(type="text/javascript" src='https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js')
  script(type="text/javascript" src='https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js')
  script(type="text/javascript" src='https://cdn.datatables.net/buttons/1.5.6/js/buttons.html5.min.js')
  script(type="text/javascript" src='https://cdn.datatables.net/1.10.19/js/dataTables.material.min.js')

  //- script(type="text/javascript" src='https://cdn.datatables.net/buttons/1.5.6/js/buttons.semanticui.min.js')
  //- script(type="text/javascript" src='https://cdn.datatables.net/buttons/1.5.6/js/buttons.semanticui.min.js')

  //- script(type='text/javascript' charset="utf8" src='https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap.min.js')

  script.
    var dataaccount=[], dataincome=[], dataexpense=[], datatransfer=[], datachart=[], datacategory=[];
    var dataaccountfilter=[], dataincomefilter=[], dataexpensefilter=[], datatransferfilter=[], datachartfilter=[];
    var accname;
    var notincluded=0;
    var nameacc;
    
    datepicker=document.getElementById("datepicker");
    nameacc=document.getElementById("nameacc");
    axios.get('/report/acreport')
    .then(response =>{
      datacategory=response.data.datacategory;
      dataaccount=response.data.dataaccount;
      dataincome=response.data.dataincome;
      dataexpense=response.data.dataexpense;
      datatransfer=response.data.datatransfer;
      datachart=response.data.datachart;
      console.log(dataaccount);
      
      $(document).ready(function() {
      var tempacc=[]
      for(var i=0;i<datacategory.length;i++){
        tempacc=[]
        for(var j=0;j<dataaccount.length;j++){
          if(datacategory[i]["category_name"]==dataaccount[j]["account_category"]){
            tempacc.push(dataaccount[j])
          }
        }
        
        $('#tableAcc'+datacategory[i]["category_name"]).DataTable({
          keys: true,
          fixedHeader: true,
          data:tempacc,
          columnDefs: [ {
                "targets": [0,1,2,3],
                "className":"text-center"
              },
              {
                "targets": 4,
                "className":"text-right"
              }
              ],
          "order": [[ 0, "desc" ]],
          columns: [
              { data: 'account_lastused' },
              { data: 'account_name' },
              { data: 'account_currency' },
              { data: 'account_category' },
              { data: 'account_balance_current' }
          ]
        });
      }
      });
    })
    .catch(error =>{
      console.log(error);
    })
      
    
    //- function show(){
    //-   document.getElementById("loader").style.display = "none";
    //-   $('#pills-tab').show();
    //-   $('#pills-home').addClass("show");
    //- }

    //- function filter(){
    //-   if(!first){
    //-   dataincomefilter=[];
    //-   dataexpensefilter=[];
    //-   datatransferfilter=[];
    //-   nameacc=document.getElementById("nameacc").value;
    //-   typecash=document.getElementById("typecash").value;
    //-   selectalldate=document.getElementById("selectalldate");
    //-   if(!datepicked){
    //-     datepicker=document.getElementById("datepicker").value;
    //-   }
    //-   datepicked=false;
    //-   if(selectalldate.checked){
    //-     document.getElementById("datepicker").disabled=true;
    //-   }
    //-   else{
    //-     document.getElementById("datepicker").disabled=false;
    //-   }
    //-   if(typecash=="All"){ 
    //-     tableincome.style.display="inline";
    //-     tableexpense.style.display="inline";
    //-     tabletransfer.style.display="inline";
    //-   }
    //-   else if(typecash=="Income"){
    //-     tableincome.style.display="inline";
    //-     tableexpense.style.display="none";
    //-     tabletransfer.style.display="none";
    //-   }
    //-   else if(typecash=="Income-Expense"){
    //-     tableincome.style.display="inline";
    //-     tableexpense.style.display="inline";
    //-     tabletransfer.style.display="none";
    //-   }
    //-   else if(typecash=="Expense"){
    //-     tableincome.style.display="none";
    //-     tableexpense.style.display="inline";
    //-     tabletransfer.style.display="none";
    //-   }
    //-   else if(typecash=="Transfer"){
    //-     tableincome.style.display="none";
    //-     tableexpense.style.display="none";
    //-     tabletransfer.style.display="inline";
    //-   }
    //-   console.log(typecash);
    //-   console.log(nameacc);
    //-   if(selectalldate.checked){
    //-     for(var i=0;i<dataincome.length;i++){ 
    //-       if(nameacc=="All"){
    //-         dataincomefilter.push(dataincome[i]);
    //-       }
    //-       else if(nameacc==dataincome[i]["income_account"]){
    //-         dataincomefilter.push(dataincome[i]);
    //-       }
    //-     }
    //-     for(var i=0;i<dataexpense.length;i++){
    //-       if(nameacc=="All"){
    //-         dataexpensefilter.push(dataexpense[i]);
    //-       }
    //-       else if(nameacc==dataexpense[i]["expense_account"]){
    //-         dataexpensefilter.push(dataexpense[i]);
    //-       }
    //-     }
    //-     for(var i=0;i<datatransfer.length;i++){
    //-       if(nameacc=="All"){
    //-         datatransferfilter.push(datatransfer[i]);
    //-       }
    //-       else if(nameacc==datatransfer[i]["transfer_src"] || nameacc==datatransfer[i]["transfer_dest"]){
    //-         datatransferfilter.push(datatransfer[i]);
    //-       }
    //-     }
    //-   }
    //-   else{
    //-     var fromdate=moment(datepicker.substring(0,10)).format("YYYY-MM-DD");
    //-     var todate=moment(datepicker.substring(13,23)).format("YYYY-MM-DD");
    //-     console.log(fromdate+"\n"+todate);

    //-     for(var i=0;i<dataincome.length;i++){ 
    //-       var indate=moment(dataincome[i]["income_date"],"DD/MM/YYYY").format("YYYY-MM-DD");
    //-       console.log(indate);
    //-       if(nameacc=="All"){
    //-         if(moment(fromdate).isSameOrBefore(indate, 'day')){
    //-           if(moment(todate).isSameOrAfter(indate, 'day')){
    //-             dataincomefilter.push(dataincome[i]);
    //-           }
    //-         }
    //-       }
    //-       else if(nameacc==dataincome[i]["income_account"]){
    //-         if(moment(fromdate).isSameOrBefore(indate, 'day')){
    //-           if(moment(todate).isSameOrAfter(indate, 'day')){
    //-             dataincomefilter.push(dataincome[i]);
    //-           }
    //-         }
    //-       }
    //-     }
    //-     for(var i=0;i<dataexpense.length;i++){
    //-       var indate=moment(dataexpense[i]["expense_date"],"DD/MM/YYYY").format("YYYY-MM-DD");
    //-       if(nameacc=="All"){
    //-         if(moment(fromdate).isSameOrBefore(indate, 'day')){
    //-           if(moment(todate).isSameOrAfter(indate, 'day')){
    //-             dataexpensefilter.push(dataexpense[i]);
    //-           }
    //-         }
    //-       }
    //-       else if(nameacc==dataexpense[i]["expense_account"]){
    //-         if(moment(fromdate).isSameOrBefore(indate, 'day')){
    //-           if(moment(todate).isSameOrAfter(indate, 'day')){
    //-             dataexpensefilter.push(dataexpense[i]);
    //-           }
    //-         }
    //-       }
    //-     }
    //-     for(var i=0;i<datatransfer.length;i++){
    //-       var indate=moment(datatransfer[i]["transfer_date"],"DD/MM/YYYY").format("YYYY-MM-DD");
    //-       if(nameacc=="All"){
    //-         if(moment(fromdate).isSameOrBefore(indate, 'day')){
    //-           if(moment(todate).isSameOrAfter(indate, 'day')){
    //-             datatransferfilter.push(datatransfer[i]);
    //-           }
    //-         }
    //-       }
    //-       else if(nameacc==datatransfer[i]["transfer_src"] || nameacc==datatransfer[i]["transfer_dest"]){
    //-         if(moment(fromdate).isSameOrBefore(indate, 'day')){
    //-           if(moment(todate).isSameOrAfter(indate, 'day')){
    //-             datatransferfilter.push(datatransfer[i]);
    //-           }
    //-         }
    //-       }
    //-     }
    //-   }
    //-   var datatableIncome = $('#tableIncome').DataTable();
    //-   datatableIncome.clear();
    //-   datatableIncome.rows.add(dataincomefilter);
    //-   datatableIncome.draw();
    //-   var datatableExpense = $('#tableExpense').DataTable();
    //-   datatableExpense.clear();
    //-   datatableExpense.rows.add(dataexpensefilter);
    //-   datatableExpense.draw();
    //-   var datatableTransfer = $('#tableTransfer').DataTable();
    //-   datatableTransfer.clear();
    //-   datatableTransfer.rows.add(datatransferfilter);
    //-   datatableTransfer.draw();
    //-   console.log(dataincomefilter);
    //-   console.log(dataexpensefilter);
    //-   console.log(datatransferfilter);
    //-   }
    //- }